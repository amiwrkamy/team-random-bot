import random

MAX_TEAM_SIZE = 5

def shuffle_teams(players, goalkeepers, team_count):
    # Ø´Ø§Ù†Ø³ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ
    random.shuffle(players)
    random.shuffle(goalkeepers)

    teams = {i: [] for i in range(1, team_count + 1)}

    # Ù‡Ø± ØªÛŒÙ… Ø­Ø¯Ø§Ú©Ø«Ø± ÛŒÚ© Ø¯Ø±ÙˆØ§Ø²Ù‡â€ŒØ¨Ø§Ù†
    for i in range(min(team_count, len(goalkeepers))):
        teams[i + 1].append(("ðŸ§¤", goalkeepers[i]))

    pool = players[:]
    random.shuffle(pool)

    for p in pool:
        # ØªÛŒÙ…â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¬Ø§ Ø¯Ø§Ø±Ù†
        available = [t for t in teams if len(teams[t]) < MAX_TEAM_SIZE]
        if not available:
            break

        # Ø§Ø®ØªÙ„Ø§Ù Û° ÛŒØ§ Û±
        min_size = min(len(teams[t]) for t in available)
        candidates = [t for t in available if len(teams[t]) == min_size]

        chosen = random.choice(candidates)
        teams[chosen].append(("âš½", p))

    return teams
